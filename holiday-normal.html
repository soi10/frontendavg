<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
    <meta name="author" content="AdminKit">
    <meta name="keywords"
        content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="shortcut icon" href="./static/img/icons/icon-48x48.png" />

    <link rel="canonical" href="https://demo-basic.adminkit.io/" />

    <title>โปรแกรมเฉลี่ยหน่วยมิเตอร์ TOU</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>



    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
        crossorigin="anonymous"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Kanit' rel='stylesheet'>

    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/i18n/datepicker-th.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="./static/css/app.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Kanit';
            font-size: 14px;
        }

        th {
            color: white;
            background: #74045F;
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <nav id="sidebar" class="sidebar js-sidebar">
            <div class="sidebar-content js-simplebar">
                <a class="sidebar-brand" href="index.html">
                    <img src="./src/img/logo.jpg" alt="Charles Hall" class="img-fluid rounded-circle" width="18%"
                        height="18%" /><span class="align-middle"> EVEREST</span>
                </a>

                <ul class="sidebar-nav">
                    <li class="sidebar-header">
                        Pages
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" href="index.html">
                            <i class="align-middle" data-feather="bar-chart-2"></i> <span
                                class="align-middle">Dashboard</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a class="sidebar-link" href="home.html">
                            <i class="align-middle" data-feather="list"></i> <span
                                class="align-middle">ข้อมูลการเฉลี่ยหน่วย</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a class="sidebar-link" href="everest.html">
                            <i class="align-middle" data-feather="sliders"></i> <span
                                class="align-middle">ดำเนินการเฉลี่ยหน่วย</span>
                        </a>
                    </li>

                    <li class="sidebar-item active">
                        <a class="sidebar-link" href="holiday-normal.html">
                            <i class="align-middle" data-feather="plus-square"></i> <span class="align-middle">ข้อมูลวัน
                                off-peak</span>
                        </a>
                    </li>
                    <li class="sidebar-header">
                        Document
                    </li>
                    <li class="sidebar-item">
                        <a class="sidebar-link" href="document.html">
                            <i class="align-middle" data-feather="book-open"></i> <span
                                class="align-middle">คู่มือการใช้งาน</span>
                        </a>
                    </li>
                    <li class="sidebar-item">
                        <a class="sidebar-link"
                            href="https://drive.google.com/drive/folders/1ajCHMZtJc7BGB4RRvZgl44ocHQETWNN3"
                            target="_blank">
                            <i class="align-middle" data-feather="calendar"></i> <span
                                class="align-middle">ดาวน์โหลดปฏิทิน TOU</span>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <div class="main">
            <nav class="navbar navbar-expand navbar-light navbar-bg">
                <a class="sidebar-toggle js-sidebar-toggle">
                    <i class="hamburger align-self-center"></i>
                </a>

                <div class="navbar-collapse collapse">
                    <ul class="navbar-nav navbar-align">
                        <li class="nav-item dropdown">
                            <a class="nav-icon dropdown-toggle d-inline-block d-sm-none" href="#"
                                data-bs-toggle="dropdown">
                                <i class="align-middle" data-feather="settings"></i>
                            </a>

                            <a class="nav-link dropdown-toggle d-none d-sm-inline-block" href="#"
                                data-bs-toggle="dropdown">
                                <span class="text-dark"><span id="Name"></span> <span id="DepartmentShortName"></span>
                                    <!-- <span id="BaName"></span> -->
                            </a>
                            <div class="dropdown-menu dropdown-menu-end">
                                <span id="outer">
                                    <a class="dropdown-item" href="#" id="btnLogout" type="button">Log out</a>
                                </span>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>

            <main class="content">
                <div class="container-fluid p-0">
                    <div class="row">
                        <div class="col">
                            <h2>ข้อมูลวัน Off-Peak ประจำปี ที่นอกจากวันเสาร์-อาทิตย์ตามปกติมีดังนี้</h2>
                        </div>
                        <div class="col-2 my-2 text-end">
                            <!-- <button type="button" class="btn btn-success" data-bs-toggle="modal"
								data-bs-target="#exampleModal">สร้างวันหยุด</button> -->
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="card my-2">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col">
                                            <div class="text-end">
                                                ปี
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="form-outline">
                                                <input type="number" id="yearNumber" class="form-control" />
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div>
                                                <button type="button" class="btn btn-success"
                                                    id="showyearHoliday">แสดง</button>
                                            </div>
                                        </div>
                                    </div>

                                    <table id="example" class="display" style="width:100%">
                                        <thead>
                                            <tr>
                                                <th class="text-center">วันที่</th>
                                                <th>วันหยุด</th>
                                                <!-- <th class="text-center">แก้ไข</th>
                                                <th class="text-center">ลบ</th> -->
                                            </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            </main>
            <footer class="footer">
                <div class="container-fluid">
                    <div class="row text-muted">
                        <div class="col-6 text-start">
                            <p class="mb-0">
                                <a href="#" class="text-muted"><strong>วัยรุ่นม่วงเดียด</strong></a>
                                &copy;<strong>2023</strong>
                            </p>
                        </div>
                        <div class="col-6 text-end">
                            <ul class="list-inline">
                                <li class="list-inline-item">
                                    <a class="text-muted" href="#">Support</a>
                                </li>
                                <li class="list-inline-item">
                                    <a class="text-muted" href="#">Help Center</a>
                                </li>
                                <li class="list-inline-item">
                                    <a class="text-muted" href="#">Privacy</a>
                                </li>
                                <li class="list-inline-item">
                                    <a class="text-muted" href="profile-team.html">Terms</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <script src="./static/js/app.js"></script>

</body>

</html>

<script>
    const hostname = "172.21.1.60";
    $(document).ready(function () {

        var emp = localStorage.getItem("Username");
        $.ajax({
            url: "http://" + hostname + ":442/admin/get",
            method: "POST",
            data: {
                adminCode: emp,
            },
            success: function (response) {
                // console.log(response.message.code);
                if (response.data.length == 0) {

                } else {
                    window.location = "./holiday.html";
                }


            },
            error: function (error) {
                console.log(error);
            }
        });

        $("#Name").html(localStorage.getItem("Fullname"));
		$("#BaName").html(localStorage.getItem("BaName"));
		$("#DepartmentShortName").html(localStorage.getItem("department"));
        let PeaCode = localStorage.getItem("Peacode").replace("3", "").substring(0, 4);
        // console.log(localStorage.getItem("Peacode").substring(0, 4))

        // $("#dateHoliday").datepicker({
        //     dateFormat: 'dd-mm-yy',
        //     language: 'th',
        //     thaiyear: true
        // });

        var yearHoliday = $("#yearNumber").val((new Date).getFullYear());
        // console.log(yearHoliday.val());
        $('#example').DataTable({
            "pageLength": 50,
            "ajax": {
                "url": "http://" + hostname + ":442/holiday/get",
                "dataSrc": "",
                "type": "POST",
                "contentType": "application/json",
                "data": function (d) {
                    return JSON.stringify({
                        yearHoliday: yearHoliday.val(),
                    });
                }, "dataSrc": "",
            },
            "columns": [
                // { "data": "dateHoliday" },
                {
                    data: null,
                    render: function (data, type, row) {
                        return '<div class="text-center">' + row.dateHoliday + '</div>';
                    }
                    , "className": "text-center",
                },
                { "data": "nameHoliday" },

            ]
        });
    });



    $("#showyearHoliday").click(function () {
        var yearHoliday = $("#yearNumber").val();

        var table = $('#example').DataTable();
        table.destroy();

        $('#example').DataTable({
            "pageLength": 50,
            "ajax": {
                "url": "http://" + hostname + ":442/holiday/get",
                "dataSrc": "",
                "type": "POST",
                "contentType": "application/json",
                "data": function (d) {
                    return JSON.stringify({
                        yearHoliday: yearHoliday,
                    });
                }, "dataSrc": "",
            },
            "columns": [
                // { "data": "dateHoliday" },
                {
                    data: null,
                    render: function (data, type, row) {
                        return '<div class="text-center">' + row.dateHoliday + '</div>';
                    }
                    , "className": "text-center",
                },
                { "data": "nameHoliday" },

            ]
        });
    })

    function convertDateFormat(oldDate) {
        // แยกวันที่ เดือน และปีออกจากกัน
        var parts = oldDate.split("-");
        var day = parts[0];
        var month = parts[1];
        var year = parts[2];

        // เปลี่ยนปีจาก 2566 เป็น 2023
        // year = parseInt(year) - 543;

        // สร้างวันที่ใหม่ในรูปแบบ "yyyy-mm-dd"
        var newDate = year + "-" + month + "-" + day;

        // ส่งคืนวันที่ใหม่
        return newDate;
    }

    function convertDateFormatYear(oldDate) {
        // แยกวันที่ เดือน และปีออกจากกัน
        var parts = oldDate.split("-");
        var day = parts[2];
        var month = parts[1];
        var year = parts[0];

        // เปลี่ยนปีจาก 2566 เป็น 2023
        // year = parseInt(year) - 543;

        // สร้างวันที่ใหม่ในรูปแบบ "yyyy-mm-dd"
        var newDate = day + "-" + month + "-" + year;

        // ส่งคืนวันที่ใหม่
        return newDate;
    }
</script>